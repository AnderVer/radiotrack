<% content_for :title, "Регистрация — RadioTrack" %>

<div class="auth-container">
  <h2 class="mb-3">Регистрация</h2>

  <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { class: "auth-form" }) do |f| %>
    <div class="form-group mb-3">
      <%= f.label :email, class: "form-label" %>
      <%= f.email_field :email, autofocus: true, autocomplete: "email", class: "form-control" %>
    </div>

    <div class="form-group mb-3">
      <%= f.label :password, class: "form-label" %>
      <%= f.password_field :password, autocomplete: "new-password", class: "form-control" %>
      <% if @minimum_password_length %>
        <small class="text-muted">(минимум <%= @minimum_password_length %> символов)</small>
      <% end %>
    </div>

    <div class="form-group mb-3">
      <%= f.label :password_confirmation, class: "form-label" %>
      <%= f.password_field :password_confirmation, autocomplete: "new-password", class: "form-control" %>
    </div>

    <div class="form-group mb-3">
      <%= f.submit "Зарегистрироваться", class: "btn btn-primary btn-block" %>
    </div>
  <% end %>

  <div class="oauth-divider">
    <span>или зарегистрируйтесь через</span>
  </div>

  <div class="oauth-buttons">
    <% if ENV["VK_APP_ID"].present? && ENV["VK_APP_SECRET"].present? %>
      <%= button_to user_vk_omniauth_authorize_path, method: :post, class: "btn btn-oauth btn-vk", form: { data: { turbo: false } } do %>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M15.073 2H8.937C5.009 2 2 5.009 2 8.937v6.126C2 18.991 5.009 22 8.937 22h6.126C18.991 22 22 18.991 22 15.063V8.937C22 5.009 18.991 2 15.073 2zM17.9 13.29c.466.466.76.836.886 1.11.125.274.08.488-.137.64-.217.152-.625.228-1.223.228h-1.67c-.637 0-1.07-.105-1.3-.316-.23-.21-.345-.45-.345-.718 0-.152.038-.376.114-.674.076-.298.133-.535.17-.71.038-.175.02-.332-.056-.47-.228-.436-.57-.84-1.024-1.212-.455-.372-.84-.62-1.155-.742-.316-.122-.56-.194-.73-.216-.17-.023-.294.07-.37.28-.152.455-.237.82-.256 1.096-.019.276.01.504.085.684.19.436.418.82.684 1.155.266.335.484.598.655.788.17.19.256.35.256.484 0 .133-.057.247-.17.34-.114.095-.304.143-.57.143h-1.85c-.637 0-1.07-.105-1.3-.316-.23-.21-.345-.45-.345-.718 0-.152.038-.376.114-.674.076-.298.133-.535.17-.71.038-.175.02-.332-.056-.47-.228-.436-.57-.84-1.024-1.212-.455-.372-.84-.62-1.155-.742-.316-.122-.56-.194-.73-.216-.17-.023-.294.07-.37.28-.152.455-.237.82-.256 1.096-.019.276.01.504.085.684.19.436.418.82.684 1.155.266.335.484.598.655.788.17.19.256.35.256.484 0 .133-.057.247-.17.34-.114.095-.304.143-.57.143H4.93c-.637 0-1.07-.105-1.3-.316-.23-.21-.345-.45-.345-.718 0-.152.038-.376.114-.674.076-.298.133-.535.17-.71.038-.175.02-.332-.056-.47-.228-.436-.57-.84-1.024-1.212-.455-.372-.84-.62-1.155-.742-.316-.122-.56-.194-.73-.216-.17-.023-.294.07-.37.28-.152.455-.237.82-.256 1.096-.019.276.01.504.085.684.19.436.418.82.684 1.155.266.335.484.598.655.788.17.19.256.35.256.484 0 .133-.057.247-.17.34-.114.095-.304.143-.57.143H2.93c-.637 0-1.07-.105-1.3-.316-.23-.21-.345-.45-.345-.718 0-.152.038-.376.114-.674.076-.298.133-.535.17-.71.038-.175.02-.332-.056-.47-.228-.436-.57-.84-1.024-1.212-.455-.372-.84-.62-1.155-.742-.316-.122-.56-.194-.73-.216-.17-.023-.294.07-.37.28-.152.455-.237.82-.256 1.096-.019.276.01.504.085.684.19.436.418.82.684 1.155.266.335.484.598.655.788.17.19.256.35.256.484 0 .133-.057.247-.17.34-.114.095-.304.143-.57.143z"/>
        </svg>
        ВКонтакте
      <% end %>
    <% end %>

    <% if ENV["YANDEX_CLIENT_ID"].present? && ENV["YANDEX_CLIENT_SECRET"].present? %>
      <%= button_to user_yandex_omniauth_authorize_path, method: :post, class: "btn btn-oauth btn-yandex", form: { data: { turbo: false } } do %>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/>
        </svg>
        Яндекс
      <% end %>
    <% end %>
  </div>

  <div class="auth-links mt-3">
    <p>Уже есть аккаунт? <%= link_to "Войти", new_user_session_path %></p>
  </div>
</div>

<style>
  .auth-container {
    max-width: 400px;
    margin: 0 auto;
    background: #fff;
    padding: 24px;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }

  .auth-form .form-control {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
  }

  .auth-form .form-label {
    display: block;
    margin-bottom: 4px;
    font-weight: 500;
  }

  .btn-block {
    width: 100%;
  }

  .oauth-divider {
    text-align: center;
    margin: 20px 0;
    position: relative;
  }

  .oauth-divider::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 0;
    right: 0;
    height: 1px;
    background: #ddd;
  }

  .oauth-divider span {
    background: #fff;
    padding: 0 12px;
    position: relative;
    color: #666;
    font-size: 14px;
  }

  .oauth-buttons {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .btn-oauth {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 10px 16px;
    border: 1px solid #ddd;
    border-radius: 4px;
    background: #fff;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.2s;
  }

  .btn-oauth:hover {
    background: #f5f5f5;
    text-decoration: none;
  }

  .btn-vk {
    color: #0077FF;
    border-color: #0077FF;
  }

  .btn-vk:hover {
    background: #0077FF;
    color: #fff;
  }

  .btn-yandex {
    color: #FC3F1D;
    border-color: #FC3F1D;
  }

  .btn-yandex:hover {
    background: #FC3F1D;
    color: #fff;
  }

  .auth-links {
    text-align: center;
    font-size: 14px;
  }

  .auth-links p {
    margin: 8px 0;
  }
</style>
