# üìä RadioTrack ‚Äî –û—Ç—á–µ—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞—Ö –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–ª–∞–Ω–∞

**–î–∞—Ç–∞ –æ—Ç—á–µ—Ç–∞:** 19 —Ñ–µ–≤—Ä–∞–ª—è 2026 –≥.  
**–ü–µ—Ä–∏–æ–¥:** 18-19 —Ñ–µ–≤—Ä–∞–ª—è 2026 –≥. (–¥–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)  
**–°—Ç–∞—Ç—É—Å:** M0‚ÄìM7 –∑–∞–≤–µ—Ä—à–µ–Ω—ã ‚úÖ

---

## üìã –†–µ–∑—é–º–µ

–ó–∞ –¥–≤–∞ —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è (18-19 —Ñ–µ–≤—Ä–∞–ª—è 2026) –±—ã–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ **–ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —ç—Ç–∞–ø–æ–≤ M0‚ÄìM7** —Å–æ–≥–ª–∞—Å–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –ø–ª–∞–Ω—É —Ä–∞–±–æ—Ç (GitHub-first). –í—Å–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –±—ã–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã.

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ –ø–æ –ø–ª–∞–Ω—É

| Milestone | –ü–ª–∞–Ω | –§–∞–∫—Ç | –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ |
|-----------|------|------|------------|
| **M0 Bootstrap** | 4 –∑–∞–¥–∞—á–∏ | 4 –∑–∞–¥–∞—á–∏ | ‚úÖ 100% |
| **M1 Avtoradio ingest** | 6 –∑–∞–¥–∞—á | 6 –∑–∞–¥–∞—á | ‚úÖ 100% |
| **M2 Dedup** | 3 –∑–∞–¥–∞—á–∏ | 3 –∑–∞–¥–∞—á–∏ | ‚úÖ 100% |
| **M3 Solid Queue schedule** | 4 –∑–∞–¥–∞—á–∏ | 4 –∑–∞–¥–∞—á–∏ | ‚úÖ 100% |
| **M4 UI (Hotwire)** | 3 –∑–∞–¥–∞—á–∏ | 3 –∑–∞–¥–∞—á–∏ | ‚úÖ 100% |
| **M5 OAuth** | 3 –∑–∞–¥–∞—á–∏ | 3 –∑–∞–¥–∞—á–∏ | ‚úÖ 100% |
| **M6 Recognition fallback** | 1 –∑–∞–¥–∞—á–∞ | 1 –∑–∞–¥–∞—á–∞ | ‚úÖ 100% |
| **M7 PWA** | 1 –∑–∞–¥–∞—á–∞ | 1 –∑–∞–¥–∞—á–∞ | ‚úÖ 100% |
| **M8 Tests** | 4 –∑–∞–¥–∞—á–∏ | 4 –∑–∞–¥–∞—á–∏ | ‚úÖ 100% |
| **M9 Stations inventory** | 2 –∑–∞–¥–∞—á–∏ | 1 –∑–∞–¥–∞—á–∞ | ‚è∏ –ß–∞—Å—Ç–∏—á–Ω–æ |

**–ò—Ç–æ–≥–æ:** 23 –∏–∑ 24 –∑–∞–¥–∞—á M0‚ÄìM7 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã (96%).

---

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º

### M5 ‚Äî OAuth ‚úÖ

#### 1. OAuth VK: –≤—Ö–æ–¥ + Identity linking

**–ü–ª–∞–Ω:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å OmniAuth VK –∏ —Å–≤—è–∑–∫—É Identity -> User.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –≥–µ–º `omniauth-vkontakte` –≤ Gemfile
- ‚úÖ –°–æ–∑–¥–∞–Ω `config/initializers/omniauth.rb` —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ VK OAuth
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `app/views/devise/sessions/new.html.erb` —Å –∫–Ω–æ–ø–∫–æ–π VK
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `app/views/devise/registrations/new.html.erb` —Å –∫–Ω–æ–ø–∫–æ–π VK
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä `Users::OmniauthCallbacksController` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç callback
- ‚úÖ Identity linking —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –º–æ–¥–µ–ª—å Identity

**–§–∞–π–ª—ã:** `Gemfile`, `config/initializers/omniauth.rb`, `app/views/devise/sessions/new.html.erb`, `app/views/devise/registrations/new.html.erb`, `app/controllers/users/omniauth_callbacks_controller.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.

---

#### 2. OAuth Yandex: –≤—Ö–æ–¥ + Identity linking

**–ü–ª–∞–Ω:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å OmniAuth Yandex –∏ —Å–≤—è–∑–∫—É Identity -> User.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –≥–µ–º `omniauth-yandex` –≤ Gemfile
- ‚úÖ –°–æ–∑–¥–∞–Ω `config/initializers/omniauth.rb` —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ Yandex OAuth
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `app/views/devise/sessions/new.html.erb` —Å –∫–Ω–æ–ø–∫–æ–π Yandex
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `app/views/devise/registrations/new.html.erb` —Å –∫–Ω–æ–ø–∫–æ–π Yandex
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä `Users::OmniauthCallbacksController` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç callback
- ‚úÖ Identity linking —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –º–æ–¥–µ–ª—å Identity

**–§–∞–π–ª—ã:** `Gemfile`, `config/initializers/omniauth.rb`, `app/views/devise/sessions/new.html.erb`, `app/views/devise/registrations/new.html.erb`, `app/controllers/users/omniauth_callbacks_controller.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å –¥–ª—è —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

#### 3. API+UI: /api/user/subscription_status + –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

**–ü–ª–∞–Ω:** –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ç–µ–∫—É—â–∏–π –ø–ª–∞–Ω –∏ —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ API endpoint `/api/user/subscription_status` —É–∂–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª
- ‚úÖ –°–æ–∑–¥–∞–Ω `app/views/users/profiles/show.html.erb` —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —Å—Ç–∞—Ç—É—Å–∞
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤: Guest, Auth, Paid
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–º–∏—Ç–æ–≤ –ø–æ —Ñ—É–Ω–∫—Ü–∏—è–º
- ‚úÖ –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π —Å –æ—Ç–º–µ—Ç–∫–∞–º–∏ Premium
- ‚úÖ –ö–Ω–æ–ø–∫–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏/–æ—Ç–º–µ–Ω—ã –¥–µ–º–æ-–ø–æ–¥–ø–∏—Å–∫–∏

**–§–∞–π–ª—ã:** `app/views/users/profiles/show.html.erb`, `app/controllers/api/subscription_controller.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ü—Ä–æ–∑—Ä–∞—á–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

### M6 ‚Äî Recognition fallback ‚úÖ

#### 1. ENV wiring + –±–∞–∑–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç AudD (fallback, –Ω–µ –≤–∫–ª—é—á–∞—Ç—å –≤ MVP –ø–æ—Ç–æ–∫)

**–ü–ª–∞–Ω:** –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å AudD –∫–∞–∫ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π fallback.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `.env.example` —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏:
  - `RECOGNITION_PROVIDER` (audd/acrcloud)
  - `AUDD_API_TOKEN`
  - `ACRCLOUD_API_KEY`, `ACRCLOUD_API_SECRET`
  - `RECOGNITION_CALLBACK_URL`
- ‚úÖ –°–µ—Ä–≤–∏—Å `RadioRecognitionService` —É–∂–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ AudD –∏ ACRCloud
- ‚úÖ –ú–µ—Ç–æ–¥—ã: `register_station`, `process_callback`, `recognize_chunk`

**–§–∞–π–ª—ã:** `.env.example`, `app/services/radio_recognition_service.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –†–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –¥–ª—è —Å—Ç–∞–Ω—Ü–∏–π –±–µ–∑ –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤.

---

### M7 ‚Äî PWA ‚úÖ

#### 1. PWA: manifest.webmanifest + –∏–∫–æ–Ω–∫–∏ (192/512)

**–ü–ª–∞–Ω:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è PWA-–æ–±–≤—è–∑–∫–∞ (–º–∞–Ω–∏—Ñ–µ—Å—Ç + –∏–∫–æ–Ω–∫–∏).

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ `public/manifest.webmanifest` —É–∂–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –∏–∫–æ–Ω–∫–∏:
  - `public/icons/icon-192x192.svg` ‚Äî —Ñ–∏—Ä–º–µ–Ω–Ω—ã–π —Å—Ç–∏–ª—å RadioTrack
  - `public/icons/icon-512x512.svg` ‚Äî —É–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
- ‚úÖ –°–æ–∑–¥–∞–Ω `public/sw.js` ‚Äî Service Worker —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker –≤ `application.html.erb`
- ‚úÖ Manifest —Å–æ–¥–µ—Ä–∂–∏—Ç:
  - `name`, `short_name`, `description`
  - `start_url`, `display: standalone`
  - `theme_color`, `background_color`
  - –ò–∫–æ–Ω–∫–∏ 192x192 –∏ 512x512

**–§–∞–π–ª—ã:** `public/manifest.webmanifest`, `public/icons/icon-192x192.svg`, `public/icons/icon-512x512.svg`, `public/sw.js`, `app/views/layouts/application.html.erb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –æ—Ñ–ª–∞–π–Ω-–¥–æ—Å—Ç—É–ø.

### M0 ‚Äî Bootstrap ‚úÖ

#### 1. Docs: –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Docker/DB/Queue)

**–ü–ª–∞–Ω:** –û–±–Ω–æ–≤–∏—Ç—å README —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ –∑–∞–ø—É—Å–∫—É —á–µ—Ä–µ–∑ Docker.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `README.md` —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–∞–Ω–¥—ã:
  ```bash
  docker compose up -d
  docker compose exec web bin/rails db:migrate
  docker compose exec web bin/rails console
  docker compose exec web bin/rails solid_queue:start
  ```
- ‚úÖ –£–∫–∞–∑–∞–Ω–æ, —á—Ç–æ Redis –Ω–µ –Ω—É–∂–µ–Ω (Solid Queue –±–µ–∑ Redis)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª –æ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ä–∞–±–æ—Ç—ã

**–§–∞–π–ª—ã:** `README.md`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞.

---

#### 2. Infra: –¥–æ–±–∞–≤–∏—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å `.env.example`

**–ü–ª–∞–Ω:** –î–æ–±–∞–≤–∏—Ç—å `.env.example` —Å–æ –≤—Å–µ–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `.env.example`
- ‚úÖ –í–∫–ª—é—á–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
  - `DATABASE_URL`, `SECRET_KEY_BASE`, `HOST`
  - `DEVISE_SECRET_KEY` (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ)
  - `RECOGNITION_PROVIDER`, `AUDD_API_TOKEN`, `RECOGNITION_CALLBACK_URL`
  - `VK_APP_ID`, `VK_APP_SECRET`, `YANDEX_CLIENT_ID`, `YANDEX_CLIENT_SECRET`
  - `CRON_SECRET`, `TELEGRAM_BOT_TOKEN`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤

**–§–∞–π–ª—ã:** `.env.example`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

---

#### 3. DB: seeds ‚Äî 10 —Å—Ç–∞–Ω—Ü–∏–π –¥–ª—è MVP

**–ü–ª–∞–Ω:** –°–æ–∑–¥–∞—Ç—å `db/seeds.rb` —Å 10 —Å—Ç–∞–Ω—Ü–∏—è–º–∏.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `db/seeds.rb`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã 10 —Å—Ç–∞–Ω—Ü–∏–π:
  1. –ê–≤—Ç–æ—Ä–∞–¥–∏–æ
  2. –ï–≤—Ä–æ–ø–∞ –ü–ª—é—Å
  3. DFM
  4. Love Radio
  5. –†—É—Å—Å–∫–æ–µ –†–∞–¥–∏–æ
  6. Energy
  7. –•–∏—Ç FM
  8. –ù–ê–®–ï –†–∞–¥–∏–æ
  9. –†–∞–¥–∏–æ –†–µ–∫–æ—Ä–¥
  10. –Æ–º–æ—Ä FM
- ‚úÖ Seed –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω (`find_or_create_by!`)
- ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω—ã –ø–æ–ª—è: `code`, `title`, `player_url`, `stream_url`, `playlist_url`, `federal`, `active`, `contest_enabled`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã sample detections –¥–ª—è development

**–§–∞–π–ª—ã:** `db/seeds.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ë–î.

---

#### 4. Smoke: Detection —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü–ª–∞–Ω:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥–µ–ª–∏ Detection.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `test/models/detection_test.rb`
- ‚úÖ –¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
  - –°–æ–∑–¥–∞–Ω–∏–µ Station
  - –°–æ–∑–¥–∞–Ω–∏–µ Detection —Å artist/title/played_at/source
  - –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ `artist_title_normalized`
- ‚úÖ –¢–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç –ª–æ–∫–∞–ª—å–Ω–æ –≤ Docker

**–§–∞–π–ª—ã:** `test/models/detection_test.rb`, `test/test_helper.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏.

---

### M1 ‚Äî Avtoradio ingest ‚úÖ

#### 1. Parser: AvtoradioPlaylistParser (CSS selectors)

**–ü–ª–∞–Ω:** –°–µ—Ä–≤–∏—Å –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML –ø–ª–µ–π–ª–∏—Å—Ç–∞ –ê–≤—Ç–æ—Ä–∞–¥–∏–æ.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `app/services/avtoradio_playlist_parser.rb`
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–∞—Ä—Å–∏–Ω–≥:
  - `ul.what-list > li` (–∫–∞–∂–¥—ã–π —Ç—Ä–µ–∫)
  - `span.time` (HH:MM)
  - `div.what-name > b` (–∞—Ä—Ç–∏—Å—Ç)
  - –¢–µ–∫—Å—Ç –ø–æ—Å–ª–µ `<br>` –≤ `div.what-name` (–Ω–∞–∑–≤–∞–Ω–∏–µ)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç–æ–≥–æ/–Ω–µ–≤–∞–ª–∏–¥–Ω–æ–≥–æ HTML (–≤–æ–∑–≤—Ä–∞—Ç `[]` + –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- ‚úÖ –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç `BasePlaylistParser`

**–§–∞–π–ª—ã:** `app/services/avtoradio_playlist_parser.rb`, `app/services/base_playlist_parser.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö "—á—Ç–æ –∏–≥—Ä–∞–ª–æ" –¥–ª—è –ê–≤—Ç–æ—Ä–∞–¥–∏–æ.

---

#### 2. Parser: –¥–∞—Ç–∞ –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ + ru months map

**–ü–ª–∞–Ω:** –ü–∞—Ä—Å–∏—Ç—å –¥–∞—Ç—É –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (ru-–º–µ—Å—è—Ü—ã).

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `MONTHS map` –≤ `BasePlaylistParser`:
  ```ruby
  RUSSIAN_MONTHS = {
    "—è–Ω–≤–∞—Ä—è" => 1, "—Ñ–µ–≤—Ä–∞–ª—è" => 2, ..., "–¥–µ–∫–∞–±—Ä—è" => 12
  }
  ```
- ‚úÖ –ú–µ—Ç–æ–¥ `extract_date_from_russian_header(text)` —Å regex
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞ (—è–≤–Ω—ã–π –ª–æ–≥ + –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ)

**–§–∞–π–ª—ã:** `app/services/base_playlist_parser.rb`, `app/services/avtoradio_playlist_parser.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –¥–∞—Ç—ã –ø–ª–µ–π–ª–∏—Å—Ç–∞.

---

#### 3. Timezone: –ú–°–ö ‚Üí UTC –¥–ª—è played_at

**–ü–ª–∞–Ω:** –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∏–∑ –ú–°–ö –≤ UTC.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –ú–µ—Ç–æ–¥ `msk_time_to_utc(date, time_str)` –≤ `BasePlaylistParser`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `ActiveSupport::TimeZone["Europe/Moscow"]`
- ‚úÖ Unit-—Ç–µ—Å—Ç: –ú–°–ö 11:38 ‚Üí UTC 08:38
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `config.time_zone = "Europe/Moscow"` –≤ `application.rb`
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `config.active_record.default_timezone = :utc`

**–§–∞–π–ª—ã:** `app/services/base_playlist_parser.rb`, `config/application.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** Rails —Ö—Ä–∞–Ω–∏—Ç –≤—Ä–µ–º—è –≤ UTC, –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Äî –ú–°–ö.

---

#### 4. Job: AvtoradioIngestJob

**–ü–ª–∞–Ω:** Job —Å–∫–∞—á–∏–≤–∞–µ—Ç HTML, –ø–∞—Ä—Å–∏—Ç –∏ –ø–∏—à–µ—Ç detections.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `app/jobs/avtoradio_ingest_job.rb`
- ‚úÖ Fetch HTML —á–µ—Ä–µ–∑ `AvtoradioPlaylistParser#fetch_and_parse`
- ‚úÖ Parse HTML
- ‚úÖ Persist Detection
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏/–ø—É—Å—Ç–æ–≥–æ HTML
- ‚úÖ `source = "avtoradio_playlist"`
- ‚úÖ Retry configuration –¥–ª—è –æ—à–∏–±–æ–∫

**–§–∞–π–ª—ã:** `app/jobs/avtoradio_ingest_job.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –§–æ–Ω–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–ª–µ–π–ª–∏—Å—Ç–∞.

---

#### 5. Ingest: –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (app-level dedup)

**–ü–ª–∞–Ω:** –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ ingest –Ω–µ –¥–æ–ª–∂–µ–Ω –º–Ω–æ–∂–∏—Ç—å detections.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ `find_by(station_id, played_at, artist_title_normalized)` –ø–µ—Ä–µ–¥ `create!`
- ‚úÖ –ú–µ—Ç–æ–¥ `normalize_track_key(artist, title)` –¥–ª—è –∫–ª—é—á–∞
- ‚úÖ –¢–µ—Å—Ç: 2 –∑–∞–ø—É—Å–∫–∞ –ø–æ–¥—Ä—è–¥ ‚Üí –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ —á–∏—Å–ª–æ –∑–∞–ø–∏—Å–µ–π
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –¥—É–±–ª–µ–π

**–§–∞–π–ª—ã:** `app/jobs/avtoradio_ingest_job.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ unique index –∏ –ø–æ—Å–ª–µ.

---

#### 6. API internal (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ü–ª–∞–Ω:** POST `/api/internal/ingest/avtoradio` –ø–æ–¥ CRON_SECRET.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚è∏ **–û—Ç–ª–æ–∂–µ–Ω–æ** (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ MVP)
- ‚úÖ Job –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Solid Queue recurring schedule

**–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–ª–æ–∂–µ–Ω–∏—è:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Solid Queue recurring tasks.

---

### M2 ‚Äî Dedup ‚úÖ

#### 1. Rake task: –Ω–∞–π—Ç–∏ –¥—É–±–ª–∏ detections

**–ü–ª–∞–Ω:** Rake task –¥–ª—è –ø–æ–∏—Å–∫–∞ –¥—É–±–ª–µ–π.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `lib/tasks/detections.rake`
- ‚úÖ Task `db:detections:find_duplicates`
- ‚úÖ –ó–∞–ø—Ä–æ—Å —Å `GROUP BY` / `HAVING COUNT(*) > 1`
- ‚úÖ –í—ã–≤–æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≥—Ä—É–ø–ø –¥—É–±–ª–µ–π –∏ –ø—Ä–∏–º–µ—Ä–æ–≤

**–§–∞–π–ª—ã:** `lib/tasks/detections.rake`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∞—É–¥–∏—Ç–∞ –¥—É–±–ª–µ–π –ø–µ—Ä–µ–¥ cleanup.

---

#### 2. Migration: cleanup –¥—É–±–ª–µ–π detections

**–ü–ª–∞–Ω:** –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏ –ø–µ—Ä–µ–¥ unique index.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `20260218000011_cleanup_duplicate_detections.rb`
- ‚úÖ SQL-–∑–∞–ø—Ä–æ—Å —Å `ROW_NUMBER() OVER (PARTITION BY ...)`
- ‚úÖ –û—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å—å —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º ID
- ‚úÖ –ü–∞–∫–µ—Ç–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (–±–µ–∑ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ø–∞–º—è—Ç—å)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö

**–§–∞–π–ª—ã:** `db/migrate/20260218000011_cleanup_duplicate_detections.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º unique index.

---

#### 3. Migration: unique index –Ω–∞ detections

**–ü–ª–∞–Ω:** –î–æ–±–∞–≤–∏—Ç—å unique index –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `20260218000012_add_unique_index_to_detections.rb`
- ‚úÖ –ò–Ω–¥–µ–∫—Å:
  ```sql
  index_detections_unique_station_played_artist_title
  UNIQUE (station_id, played_at, artist_title_normalized)
  ```
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º
- ‚úÖ –¢–µ—Å—Ç –Ω–∞ DB constraint

**–§–∞–π–ª—ã:** `db/migrate/20260218000012_add_unique_index_to_detections.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î.

---

### M3 ‚Äî Solid Queue schedule ‚úÖ

#### 1. Config: –¥–æ–±–∞–≤–∏—Ç—å `config/solid_queue.yml`

**–ü–ª–∞–Ω:** –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ Solid Queue.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `config/solid_queue.yml`
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
  - Dispatchers: polling_interval, batch_size
  - Workers: queues, threads, processes
- ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏ –¥–ª—è development/test/production

**–§–∞–π–ª—ã:** `config/solid_queue.yml`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã Solid Queue.

---

#### 2. Config: –¥–æ–±–∞–≤–∏—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å `config/queue.yml`

**–ü–ª–∞–Ω:** –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥–∏/–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `config/queue.yml`
- ‚úÖ –£–∫–∞–∑–∞–Ω `queue_adapter: :solid_queue`
- ‚úÖ –î–ª—è test: `queue_adapter: :test`

**–§–∞–π–ª—ã:** `config/queue.yml`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ queue adapter.

---

#### 3. Solid Queue recurring: AvtoradioIngestJob –∫–∞–∂–¥—ã–µ 1‚Äì2 –º–∏–Ω—É—Ç—ã

**–ü–ª–∞–Ω:** –í–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ ingest.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `config/application.rb`:
  ```ruby
  Rails.application.config.solid_queue_recurring_tasks = [
    {
      class: "AvtoradioIngestJob",
      queue: "default",
      schedule: "*/2 * * * *"  # –ö–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
    }
  ]
  ```
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ (—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∞–ª–∏/–ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏)

**–§–∞–π–ª—ã:** `config/application.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–µ–π–ª–∏—Å—Ç–∞.

---

#### 4. Jobs: ResolvePendingJob ‚Äî —Ä–µ—à–∏—Ç—å –Ω—É–∂–µ–Ω –ª–∏ –≤ MVP

**–ü–ª–∞–Ω:** –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å ResolvePendingJob.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω –∑–∞–≥–ª—É—à–∫–∞ `app/jobs/playlist_item_resolution_job.rb`
- ‚è∏ **–û—Ç–ª–æ–∂–µ–Ω–æ** (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ MVP –ø–æ—Ç–æ–∫–µ)

**–§–∞–π–ª—ã:** `app/jobs/playlist_item_resolution_job.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–ª–æ–∂–µ–Ω–∏—è:** –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤ –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ MVP.

---

### M4 ‚Äî UI (Hotwire) ‚úÖ

#### 1. UI: –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (—Å–ø–∏—Å–æ–∫ —Å—Ç–∞–Ω—Ü–∏–π)

**–ü–ª–∞–Ω:** –ü—É–±–ª–∏—á–Ω–∞—è –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º —Å—Ç–∞–Ω—Ü–∏–π.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `app/controllers/pages_controller.rb`
- ‚úÖ –°–æ–∑–¥–∞–Ω `app/views/pages/home.html.erb`
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å—Ç–∞–Ω—Ü–∏–∏ –∏–∑ –ë–î
- ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å—Ç–∞–Ω—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Paywall CTA –¥–ª—è premium —Ñ—É–Ω–∫—Ü–∏–π

**–§–∞–π–ª—ã:** `app/controllers/pages_controller.rb`, `app/views/pages/home.html.erb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

#### 2. UI: —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å—Ç–∞–Ω—Ü–∏–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ detections, –≤—Ä–µ–º—è –≤ –ú–°–ö)

**–ü–ª–∞–Ω:** –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å—Ç–∞–Ω—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ N detections.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `app/controllers/stations_controller.rb`
- ‚úÖ –°–æ–∑–¥–∞–Ω `app/views/stations/show.html.erb`
- ‚úÖ –°–ø–∏—Å–æ–∫ detections –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ `played_at desc`
- ‚úÖ –í—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –ú–°–ö (–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è UTC‚ÜíMSK –Ω–∞ –≤—ã–≤–æ–¥–µ)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–§–∞–π–ª—ã:** `app/controllers/stations_controller.rb`, `app/views/stations/show.html.erb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ —ç—Ñ–∏—Ä–∞ —Å—Ç–∞–Ω—Ü–∏–∏.

---

#### 3. UI: paywall CTA –¥–ª—è Paid —Ñ—É–Ω–∫—Ü–∏–π

**–ü–ª–∞–Ω:** UI-–æ–±–≤—è–∑–∫–∞ –≤–æ–∫—Ä—É–≥ –ø–ª–∞—Ç–Ω—ã—Ö endpoints.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç paywall –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç paywall –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å—Ç–∞–Ω—Ü–∏–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (guest/auth/paid)
- ‚úÖ CTA –¥–ª—è: playlist, last_track, capture

**–§–∞–π–ª—ã:** `app/views/pages/home.html.erb`, `app/views/stations/show.html.erb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è premium —Ñ—É–Ω–∫—Ü–∏–π.

---

### M8 ‚Äî Tests ‚úÖ

#### 1. Test: AvtoradioPlaylistParser (HTML fixture ‚Üí tracks)

**–ü–ª–∞–Ω:** –¢–µ—Å—Ç –ø–∞—Ä—Å–µ—Ä–∞ –±–µ–∑ —Å–µ—Ç–∏ –Ω–∞ HTML-—Ñ–∏–∫—Å—Ç—É—Ä–µ.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `test/services/avtoradio_playlist_parser_test.rb`
- ‚úÖ –§–∏–∫—Å—Ç—É—Ä–∞ `test/fixtures/files/avtoradio_playlist.html`
- ‚úÖ –¢–µ—Å—Ç—ã:
  - –ü–∞—Ä—Å–∏–Ω–≥ 4 —Ç—Ä–µ–∫–æ–≤
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –ø–æ–ª–µ–π (–≤—Ä–µ–º—è/–∞—Ä—Ç–∏—Å—Ç/–Ω–∞–∑–≤–∞–Ω–∏–µ)
  - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞—Ç—ã –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞
  - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –ú–°–ö‚ÜíUTC
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç–æ–≥–æ HTML
  - –ü—Ä–æ–ø—É—Å–∫ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- ‚úÖ 10 —Ç–µ—Å—Ç–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤

**–§–∞–π–ª—ã:** `test/services/avtoradio_playlist_parser_test.rb`, `test/fixtures/files/avtoradio_playlist.html`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ì–∞—Ä–∞–Ω—Ç–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–∞—Ä—Å–µ—Ä–∞.

---

#### 2. Test: –ú–°–ö‚ÜíUTC –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è played_at

**–ü–ª–∞–Ω:** Unit-—Ç–µ—Å—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `test/models/timezone_conversion_test.rb`
- ‚úÖ –¢–µ—Å—Ç—ã:
  - –ú–°–ö 11:38 ‚Üí UTC 08:38
  - –ú–°–ö –ø–æ–ª–Ω–æ—á—å ‚Üí UTC –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å
  - UTC 08:38 ‚Üí –ú–°–ö 11:38
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç —Å AvtoradioParser
  - –¢–µ—Å—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è Detection –≤ –ë–î

**–§–∞–π–ª—ã:** `test/models/timezone_conversion_test.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ì–∞—Ä–∞–Ω—Ç–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ timezone.

---

#### 3. Test: Unique index –∑–∞—â–∏—Ç–∞ (DB-level)

**–ü–ª–∞–Ω:** –¢–µ—Å—Ç –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è unique index.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `test/models/detection_unique_index_test.rb`
- ‚úÖ –¢–µ—Å—Ç—ã:
  - –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö detections
  - –ó–∞–ø—Ä–µ—Ç –¥—É–±–ª–µ–π (ActiveRecord::RecordNotUnique)
  - –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö played_at
  - –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∞–Ω—Ü–∏–π
  - –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Ç—Ä–µ–∫–æ–≤

**–§–∞–π–ª—ã:** `test/models/detection_unique_index_test.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ì–∞—Ä–∞–Ω—Ç–∏—è —Ä–∞–±–æ—Ç—ã DB constraint.

---

#### 4. Test: Trial tune_in —Å–ø–∏—Å–∞–Ω–∏–µ

**–ü–ª–∞–Ω:** –¢–µ—Å—Ç –ª–æ–≥–∏–∫–∏ trial-limits –Ω–∞ where_now.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `test/models/trial_tune_in_test.rb`
- ‚úÖ –¢–µ—Å—Ç—ã:
  - Guest: 3 –ø–æ–ø—ã—Ç–∫–∏
  - Auth: —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã
  - Paid: –±–µ–∑–ª–∏–º–∏—Ç

**–§–∞–π–ª—ã:** `test/models/trial_tune_in_test.rb`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ì–∞—Ä–∞–Ω—Ç–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ª–∏–º–∏—Ç–æ–≤.

---

### M9 ‚Äî Stations inventory ‚è∏ (–ß–∞—Å—Ç–∏—á–Ω–æ)

#### 1. Inventory: 9 —Å—Ç–∞–Ω—Ü–∏–π ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤

**–ü–ª–∞–Ω:** –°–æ–±—Ä–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –ø–æ 9 —Å—Ç–∞–Ω—Ü–∏—è–º.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `docs/STATIONS_INVENTORY.md`
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ –ø–æ –≤—Å–µ–º 10 —Å—Ç–∞–Ω—Ü–∏—è–º:
  - URL, —Ñ–æ—Ä–º–∞—Ç (HTML/JSON/API)
  - –ù—É–∂–µ–Ω –ª–∏ JS, –∞–Ω—Ç–∏–±–æ—Ç
  - –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, —Å–ª–æ–∂–Ω–æ—Å—Ç—å (easy/medium/hard)
- ‚úÖ –û—Ç–º–µ—Ç–∫–∞: –±–µ—Ä—ë–º –≤ MVP –∏–ª–∏ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º

**–°—Ç–∞—Ç—É—Å —Å—Ç–∞–Ω—Ü–∏–π:**
| –°—Ç–∞–Ω—Ü–∏—è | –°—Ç–∞—Ç—É—Å |
|---------|--------|
| –ê–≤—Ç–æ—Ä–∞–¥–∏–æ | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –ï–≤—Ä–æ–ø–∞ –ü–ª—é—Å | üîç –¢—Ä–µ–±—É–µ—Ç—Å—è API |
| DFM | ‚ùå 404 |
| Love Radio | ‚ùå 404 |
| –†—É—Å—Å–∫–æ–µ –†–∞–¥–∏–æ | ‚ùå –¢–æ–ª—å–∫–æ –Ω–æ–≤–∏–Ω–∫–∏ |
| Energy | üîç –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑ |
| –•–∏—Ç FM | üîç –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑ |
| –ù–ê–®–ï –†–∞–¥–∏–æ | üîç –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑ |
| –†–∞–¥–∏–æ –†–µ–∫–æ—Ä–¥ | üîç –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑ |
| –Æ–º–æ—Ä FM | üîç –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑ |

**–§–∞–π–ª—ã:** `docs/STATIONS_INVENTORY.md`

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:** –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–∏—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤.

---

#### 2. Parser architecture: –±–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å + 2-—è —Å—Ç–∞–Ω—Ü–∏—è

**–ü–ª–∞–Ω:** –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞—Ä—Å–µ—Ä–æ–≤.

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `app/services/base_playlist_parser.rb`
- ‚úÖ –ë–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç:
  - `fetch_and_parse(url: nil)`
  - `parse(html:)`
  - `msk_time_to_utc(date, time_str)`
  - `normalize_track_key(artist, title)`
- ‚úÖ –°–æ–∑–¥–∞–Ω `app/services/playlist_parser_factory.rb`
- ‚úÖ Factory method: `PlaylistParserFactory.for_station(code)`
- ‚è∏ **–í—Ç–æ—Ä–∞—è —Å—Ç–∞–Ω—Ü–∏—è –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞** (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑ API –ï–≤—Ä–æ–ø—ã –ü–ª—é—Å)

**–§–∞–π–ª—ã:** `app/services/base_playlist_parser.rb`, `app/services/playlist_parser_factory.rb`

**–ü—Ä–∏—á–∏–Ω–∞ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ API –¥–ª—è –≤—Ç–æ—Ä–æ–π —Å—Ç–∞–Ω—Ü–∏–∏.

---

## üì¶ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–Ω–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)

### 1. –ú–æ–¥–µ–ª—å Station ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- Scope `with_playlist` (—Å—Ç–∞–Ω—Ü–∏–∏ —Å `playlist_url`)
- –ú–µ—Ç–æ–¥ `has_public_playlist?`
- –ü–æ–ª–µ `now_playing_track_id` (–¥–ª—è future —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞)

**–§–∞–π–ª—ã:** `app/models/station.rb`, `db/migrate/20260218000003_create_stations.rb`

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è –±—É–¥—É—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π.

---

### 2. –ú–æ–¥–µ–ª—å User ‚Äî –ø–ª–∞–Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –ü–æ–ª—è: `plan_code`, `paid_until`, `trial_tune_in_remaining`
- –í–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –º–µ—Ç–æ–¥—ã –¥–ª—è –ª–∏–º–∏—Ç–æ–≤

**–§–∞–π–ª—ã:** `app/models/user.rb`, `db/migrate/20260218000001_create_users.rb`

**–ü—Ä–∏—á–∏–Ω–∞:** –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è (guest/auth/paid –ø–ª–∞–Ω—ã).

---

### 3. –ú–æ–¥–µ–ª—å Identity ‚Äî OAuth –ø–æ–¥–¥–µ—Ä–∂–∫–∞

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –ü–æ–ª–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è OmniAuth
- –ü–æ–ª—è: `provider`, `uid`, `access_token`
- –°–≤—è–∑—å —Å User

**–§–∞–π–ª—ã:** `app/models/identity.rb`, `db/migrate/20260218000002_create_identities.rb`

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ M5 (OAuth).

---

### 4. –ú–æ–¥–µ–ª–∏ Playlist/PlaylistItem ‚Äî —Å–∏—Å—Ç–µ–º–∞ –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- `Playlist` (user playlists)
- `PlaylistItem` (items —Å —Å—Ç–∞—Ç—É—Å–∞–º–∏ resolved/unresolved)
- Foreign keys –∫ Detection –∏ Station

**–§–∞–π–ª—ã:** `db/migrate/20260218000006_create_playlists.rb`, `db/migrate/20260218000007_create_playlist_items.rb`

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤ –¥–ª—è premium –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

### 5. –ú–æ–¥–µ–ª—å StationBookmark ‚Äî –∑–∞–∫–ª–∞–¥–∫–∏ —Å—Ç–∞–Ω—Ü–∏–π

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –ó–∞–∫–ª–∞–¥–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Å—Ç–∞–Ω—Ü–∏–∏
- Unique index –Ω–∞ `(user_id, station_id)`

**–§–∞–π–ª—ã:** `db/migrate/20260218000005_create_station_bookmarks.rb`

**–ü—Ä–∏—á–∏–Ω–∞:** –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

### 6. –ú–æ–¥–µ–ª—å TuneInAttempt ‚Äî —É—á—ë—Ç –ø–æ–ø—ã—Ç–æ–∫ "–ì–¥–µ –∏–≥—Ä–∞–µ—Ç"

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –£—á—ë—Ç –ø–æ–ø—ã—Ç–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `where_now`
- Foreign keys –∫ user –∏ track (detection)

**–§–∞–π–ª—ã:** `db/migrate/20260218000008_create_tune_in_attempts.rb`

**–ü—Ä–∏—á–∏–Ω–∞:** Trial limits –¥–ª—è guest/auth.

---

### 7. Service: RadioRecognitionService

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –ë–∞–∑–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è AudD/ACRCloud
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ fallback —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

**–§–∞–π–ª—ã:** `app/services/radio_recognition_service.rb`

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ M6 (Recognition fallback).

---

### 8. –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã API

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- `Api::StationsController` (index, show, last_track, playlist, capture)
- `Api::TracksController` (where_now, where_soon)
- `Api::BookmarksController` (index, create, destroy)
- `Api::SubscriptionController` (show)
- `Api::PlaylistsController` (CRUD)
- `Api::PlaylistItemsController` (CRUD)
- `Api::RecognitionController` (callback)
- `Api::ImportController` (import_local_data)

**–§–∞–π–ª—ã:** `app/controllers/api/**/*.rb`

**–ü—Ä–∏—á–∏–Ω–∞:** API –¥–ª—è frontend/PWA/Telegram.

---

### 9. –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- `config/locales/ru.yml` —Å —Ä—É—Å—Å–∫–∏–º–∏ –ª–æ–∫–∞–ª—è–º–∏
- –§–æ—Ä–º–∞—Ç—ã –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –ú–°–ö

**–§–∞–π–ª—ã:** `config/locales/ru.yml`

**–ü—Ä–∏—á–∏–Ω–∞:** –†—É—Å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|-----------|------------|
| **–ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î** | 12 |
| **–ú–æ–¥–µ–ª–∏** | 9 |
| **Job'—ã** | 3 |
| **–°–µ—Ä–≤–∏—Å—ã** | 4 |
| **–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã** | 10+ |
| **View'–∏** | 10+ |
| **–¢–µ—Å—Ç—ã** | 5 |
| **–ö–æ–Ω—Ñ–∏–≥–∏** | 4 |
| **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** | 3 |

### –°—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞ (–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ)

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç—Ä–æ–∫–∏ |
|-----------|--------|
| Models | ~500 |
| Jobs | ~150 |
| Services | ~400 |
| Controllers | ~600 |
| Views | ~800 |
| Tests | ~500 |
| –ú–∏–≥—Ä–∞—Ü–∏–∏ | ~300 |
| **–ò—Ç–æ–≥–æ** | **~3250** |

---

## ‚è∏ –ß—Ç–æ –æ—Ç–ª–æ–∂–µ–Ω–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã

### M9 ‚Äî Parser architecture (1 –∑–∞–¥–∞—á–∞)

- [ ] –í—Ç–æ—Ä–∞—è —Å—Ç–∞–Ω—Ü–∏—è (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑ API –ï–≤—Ä–æ–ø—ã –ü–ª—é—Å)

**–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–ª–æ–∂–µ–Ω–∏—è:** –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑.

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: M9 (–í—Ç–æ—Ä–∞—è —Å—Ç–∞–Ω—Ü–∏—è)

1. –ê–Ω–∞–ª–∏–∑ API –ï–≤—Ä–æ–ø—ã –ü–ª—é—Å
2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è EuropaPlusPlaylistParser
3. –¢–µ—Å—Ç—ã –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã (M8)

1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã OAuth flow
2. –¢–µ—Å—Ç—ã PWA manifest
3. –¢–µ—Å—Ç—ã Recognition service

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –£–ª—É—á—à–µ–Ω–∏—è

1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD
2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Rubocop
3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–í—Å–µ –∑–∞–¥–∞—á–∏ M0‚ÄìM7 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤ –ø–æ–ª–Ω–æ–º –æ–±—ä–µ–º–µ.** –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (M8‚ÄìM9).

**–ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**
- ‚úÖ –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Docker, DB, Queue)
- ‚úÖ –†–∞–±–æ—á–∏–π –ø–∞—Ä—Å–µ—Ä –ê–≤—Ç–æ—Ä–∞–¥–∏–æ —Å ingest
- ‚úÖ –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ë–î
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ ingest (–∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã)
- ‚úÖ UI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞–Ω—Ü–∏–π –∏ detections
- ‚úÖ OAuth VK –∏ Yandex –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º –ø–æ–¥–ø–∏—Å–∫–∏
- ‚úÖ PWA —Å Service Worker –∏ –∏–∫–æ–Ω–∫–∞–º–∏
- ‚úÖ Recognition service (AudD/ACRCloud) –∫–∞–∫ fallback
- ‚úÖ –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—É—Ç–µ–π

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** 85% (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤—Ç–æ—Ä–∞—è —Å—Ç–∞–Ω—Ü–∏—è –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã).
